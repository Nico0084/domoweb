<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="-1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Domoweb</title>
  <link rel="stylesheet" href="/libraries/bootstrap-3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="/libraries/notifit/notifIt%21-1.1/css/notifIt.css">
  <link rel="stylesheet" href="/css/style.css">
  <style type="text/css" id="sectionstyle" shim-shadowdom>
  body {
    background-attachment: fixed;
    background-position: {{ params['SectionBackgroundPosition'] }};
    background-repeat: {{ params['SectionBackgroundRepeat'] }};
    background-size: {{ params['SectionBackgroundSize'] }};
    background-image: {% if 'SectionBackground' in params %}url('/backgrounds/{{params['SectionBackground']}}'){% else %}{% raw params['SectionBackgroundImage'] %}{% end %};
  }
  body /deep/ .widget.style-general {
    border: 1px solid {{ params['WidgetBorderColor'] }};
    background-color: {{ params['WidgetBackgroundColor'] }};
    border-radius: {{ params['WidgetBorderRadius'] }};
    color: {{ params['WidgetTextColor'] }};
    box-shadow: {{ params['WidgetBoxShadow'] }};
  }
  </style>
  <script type="text/javascript">
    var DMW = DMW || {};
    DMW.main = DMW.main || {};
    DMW.main.edit = false;

//    DMW.main.sectionid = {{ section.id }};
  </script>
  <script src="/libraries/webcomponentsjs/webcomponents.js"></script>
  <script src="/libraries/jquery-1.11.0/jquery.min.js"></script>
  <script type="text/javascript" src="/libraries/i18next/i18next.min.js"></script>
  <script type="text/javascript">
    i18n.init({
      getAsync: false,
      load: 'current',
      //        lng: "en-US",
      fallbackLng: 'en-US',
      resGetPath: 'locales/__ns__/__lng__/translation.json',
      ns: {
        namespaces: ['domoweb', {% for pack in packs %}'{{pack[0]}}', {% end %}], 
        defaultNs: 'domoweb'
      }
    });
  </script>
  <link rel="import" href="/components/polymer-ajax.html">
  <link rel="import" href="/components/websockets.html">
  <link rel="import" href="/components/widget.html">
  <link rel="import" href="/components/datatypes.html">
  <link rel="import" href="/components/section.html">
  <!--link rel="import" href="/components/mainMenu.html"-->
  <link rel="import" href="/components/navigation.html">
  <link rel="import" href="/components/widgetsSelector.html">
  <link rel="import" href="/components/sectionslist.html">
</head>
<body unresolved>
  <dmw-datatypes id="datatypes"></dmw-datatypes>
  <web-socket id="socket"></web-socket>
  <polymer-ajax id="ajax" method="POST" url="/configuration"></polymer-ajax>
  <dmw-section id='currentsection' sectionid="{{ section.id }}"></dmw-section>
	<main role="main">
    <div id='grid-layout'></div>
    <dmw-navigation>
     <ul>
       <li id="menuConfigure" data-i18n="menu.configuration"></li>
       <li id="menuWidgets" data-i18n="menu.widgets">
         <ul>
           <li id="menuFinishWidgets" data-i18n="menu.finishWidgets" data-close="true"></li>
           <li id="menuAddWidget" data-i18n="menu.addwidget"></li>
         </ul>
       </li>
       <li id="menuSections" data-i18n="menu.sections">
          <ul>
           <li id="menuFinishSections" data-i18n="menu.finishSections" data-close="true"></li>
           <li id="menuAddSection" data-i18n="menu.addsection"></li>
          </ul>
       </li>
     </ul>
    </dmw-navigation>
    <div id="modal-overlay" class="overlay"></div>
	</main>
  <script src="/libraries/bootstrap-3.2.0/js/bootstrap.min.js"></script>
  <script src="/libraries/d3/d3.min.js"></script>
  <script src="/libraries/moment/min/moment.min.js"></script>
  <script type="text/javascript" src="/libraries/notifit/notifIt%21-1.1/js/notifIt.js"></script>
  <script src="/js/main.js"></script>
    <link rel="stylesheet" href="/css/grid-layout.css">
  <script src="/libraries/packery/dist/packery.pkgd.min.js"></script>
  <script src="/libraries/draggability/draggabilly.js"></script>
    <script src="/js/grid-layout.js"></script>

      <script type="text/javascript">
    window.addEventListener('polymer-ready', function(){
      DMW.main.socket.addEventListener('websocket-connected', websocketConnected);
      DMW.main.socket.addEventListener('websocket-closed', websocketClosed);
      DMW.main.socket.register('widgetinstance-added', instanceAdded);
      DMW.main.socket.register('widgetinstance-removed', instanceRemoved);        
      DMW.main.navigation.addEventListener('menuitem-selected', menuitemSelected, false);
      DMW.main.section.addEventListener('section-updated', sectionUpdated);
    });
  </script>
  </body>
</html>

