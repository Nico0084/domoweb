{% load i18n %}
<script type='text/javascript'>
    $(function(){
        rinor.get(['api', 'feature'])
            .done(function(data, status, xhr){
                $.each(data.objects, function(index, object) {
                    var group = $("optgroup#" + object.device_id).first();
                    if (group.length == 0) {
                        group = $("<optgroup id='" + object.device_id +"_"+object.device_feature_model.stat_key+"' label='[" + object.device.device_type_id + "] " + object.device.name + "'></optgroup>");
                        $("select#features1").append(group);
                    }                    
                    group.append("<option value='" + object.id + "'>" + object.device_feature_model.name + "</option>");
                    var test=object.device_feature_model.parameters
                    test=test.replace(/&quot;/g," ");
                    if (object.device_feature_model.feature_type == "actuator") {
                        var group2 =  $("optgroup#" + object.device_id).first(); 
                        if (group2.length == 0) {
                            group2 = $("<optgroup id='" + object.device_id + "' label='[" + object.device.device_type_id + "] " + object.device.name + "'></optgroup>");
                            $("select#sortieVrai").append(group2);
                            }   
                        group2.append("<option value='" + object.id + "'>" + object.device_feature_model.name + "</option>");
                    }
                    });
                
                $("select#features2").append($("select#features1").clone().html());
                $("select#sortieFaux").append($("select#sortieVrai").clone().html());
                $("select.listes").chosen();
           })
            .fail(function(jqXHR, status, error){
                if (jqXHR.status == 400)
                    $.notification('error', '{% trans "Device list not retrieved" %} (' + jqXHR.responseText + ')');
            });
       
        $("select#features1").change(function(){
              var test = $("optgroup#2").first();
              test=$("<optgroup id='1' label='test'></optgroup>");
             test.append="<option value='1'> 'test'</option>";
             $("select#test1").append(test);
             $("selec#test1").chosen();
        });
       
} )   ;

</script>
<section class="subsection">
    <h2>{% trans "Created Scene" %}</h2>
    <select id="features1" class='listes' style="width:30em;"></select>
    <select id="test1" class='listes' style="width:10em;"></select>
    <select id="value1" style="width:20em;"></select>
    </p>
    <select id="TestFeature" class='listes' style="width:10em;"></select>
    </p>
    <select id="features2" class='listes' style="width:30em;"></select>
    <select id="test2" class='listes' style="width:10em;"></select>
    <select id="value2" style="width:30em;"></select>
    </p>
    <h3>{% trans "If True" %}</h3>
    <select id="sortieVrai" class='listes' style="width:30em;"></select>
    <select id="valueVrai" style="width:20em;"></select>
    <h3>{% trans "If Wrong" %}</h3>
    <select id="sortieFaux" class='listes' style="width:30em;"></select>
    <select id="valueFaux" style="width:20em;"></select>



    <p>Rinor Url :{{ request.session.rinor_ip }}:{{ request.session.rinor_port }}</p> 
</section>
