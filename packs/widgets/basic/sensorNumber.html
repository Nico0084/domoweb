<polymer-element name="dmw-basic-sensorNumber" extends="dmw-widget">
	<template>
		<link rel="stylesheet" href="/widget/basic/css/common.css">
		<style type="text/css">
			:host {
				height: 100%;
			}
			#number {
				position: relative;
				top: 50%;
				-webkit-transform: translateY(-50%);
				-ms-transform: translateY(-50%);
				transform: translateY(-50%);
	  			text-align: center;
				font-size: 4em;
				overflow: hidden;
			}
			#unit {
				position: absolute;
				top:5px;
				right: 5px;
				font-size: 1em;
			}
		</style>
	    <dmw-sensor id='primary' sensorkey="primary" sensorvalue="{{sensorvalue}}"></dmw-sensor>
		<shadow></shadow>
		<div id='number'>{{number}}</div>
		<div id='unit'>{{unit}}</div>
	</template>
	<script>
		Polymer('dmw-basic-sensorNumber', {
			ready: function() {
				this.super();
				this.number = "--";
				this.unit = "-"
			},
			paramsReady: function() {
				if (this.$.primary.isSet) {
					this.labelprimary = this.$.primary.device['name'];
					this.labelsecondary = this.$.primary.name;
					this.displayValue(this.$.primary.last_value, this.datatypes[this.$.primary.datatype_id]['unit']);
				}		
			},
			sensorvalueChanged: function(oldValue, newValue) {
				this.displayValue(newValue, this.datatypes[this.$.primary.datatype_id]['unit']);
			},
			displayValue: function(number, unit) {
				if (this.options['autoconvert']==1 && number > 0) {
				   	var k = 1000;
				   	var sizes = ['', 'K', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y'];
				   	var i = Math.floor(Math.log(number) / Math.log(k));
					this.number = (number / Math.pow(k, i)).toPrecision(3);
					this.unit = sizes[i] + i18n.t("basic:unit", { context: this.$.primary.datatype_id, value: unit });
				} else {
					this.number = number;
					this.unit = i18n.t("basic:unit", { context: this.$.primary.datatype_id, value: unit });
				}
			}
		});
	</script>
</polymer-element>