<polymer-element name="dmw-basic-commandString" extends="dmw-widget">
	<template>
		<style type="text/css">
			:host {
				height: 100%;
				padding: 0.5em;
			}
			#labelprimary {
				display: block;
				font-size: 0.8em;
				position: absolute;
				top: -1.4em;
				left: 0;
				text-overflow: ellipsis;
			}
			#labelsecondary {
				display: block;
				transform: rotate(-90deg);
				transform-origin: bottom left;
				-ms-transform: rotate(-90deg);
				-ms-transform-origin: bottom left;
				-webkit-transform: rotate(-90deg);
				-webkit-transform-origin: bottom left;
				position: absolute;
				left: 0;
				bottom: 0;
				font-size: 0.8em;
				text-overflow: ellipsis;
			}
			textarea#text {
				width: 100%;
				height: 70%;
				color: #000000;
			}
			button#send {
				float: right;
			}
		</style>
	    <dmw-command commandkey="text"></dmw-command>
		<shadow></shadow>
		<textarea id="text" aria-labeledby="labelprimary"></textarea>
		<button id="send" class="btn btn-primary btn-xs"></button>
	</template>
	<script>
		Polymer('dmw-basic-commandString', {
			ready: function() {
				this.super();
				this.$.send.innerHTML = i18n.t("basic:send");
				this.$.send.addEventListener('click', this.send.bind(this));
			},
			paramsReady: function() {
				var command = this.shadowRoot.querySelector('dmw-command[commandkey="text"]');
				if (this.commands['primary']) {
					command.setAttribute('commandid', this.commands['primary']['id']);
					this.labelprimary = this.commands['primary']['name'];
					this.labelsecondary = this.commands['primary']['device']['name'];
				}
			},
			send: function(e) {
				var json = {"command_id":this.commands['primary']['id'], "parameters": {}};
				json['parameters'][this.commands['primary']['parameters'][0]['key']] = this.$.text.value;
				this.$.socket.send("command-send", json);
				this.$.text.value = null;
				e.preventDefault();
				e.stopPropagation();
			}
		});
	</script>
</polymer-element>